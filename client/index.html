
<html>
  <head>
<style>
</style>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.js'></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/redux/4.0.4/redux.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/react-router-dom/5.0.0/react-router-dom.js'></script>
  </head>
  <body>
    <div id='root'></div>
    <script type='text/babel'>
      const {HashRouter, Route, Link} = ReactRouterDOM;

      const initialState = { schools: [], students: []};

      const store = Redux.createStore((state = [], action)=>{
        switch(action.type){
          case 'SET_SCHOOLS':
            state = action.schools;
            break
          case 'SET_STUDENTS':
            state = action.students;
            break
        }
        return state;
      });

      const start = async()=> {
        const schoolRes = await axios.get('/api/schools');
        store.dispatch({type: 'SET_SCHOOLS', schools: schoolRes.data});
        const studentRes  = await axios.get('/api/students');
        store.dispatch({type: 'SET_STUDENTS', students: studentRes.data});
      }

      start();

      class Nav extends React.Component {
        constructor(){
          super();
          this.state = {
            schools: store.getState(),
            students: store.getState()
          }
        }
        componentDidMount(){
          store.subscribe(()=>{
            this.setState({schools: store.getState(), students: store.getState()});

          })
        }

        render(){
          const {schools, students} = this.state;
          console.log(schools);
          const links = [
            {text: 'Home', to: '/'},
            {text: `Schools (${ schools.length })`, to: '/schools'},
            {text: `Students (${ students.length })`, to: '/students'},
            {text: 'Most Popular', to: '/schools/:id?'},
            {text: 'Top School', to: '/schools/:id??'}
          ];

          return(
            <div id='nav'>
              {
                links.map((link, idx)=> <Link key={ idx } to={ link.to }>{ link.text }</Link>)
              }
            </div>
          );
        }
      }

      const Home = ()=> <h2>Home</h2>

      const App = ()=> {
        return(
          <HashRouter>
            <Route component = { Nav } />
            <Route path = '/' exact component = { Home } />
          </HashRouter>
        )

      }

      const root = document.querySelector('#root');
      ReactDOM.render(<App />, root);
    </script>
  </body>
</html>
